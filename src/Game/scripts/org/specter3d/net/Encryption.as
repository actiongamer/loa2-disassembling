package org.specter3d.net
{
   import flash.utils.ByteArray;
   
   public class Encryption
   {
      
      private static var instance:org.specter3d.net.Encryption;
      
      private static var dictionary:Array = [[38,239,247,68,214,50,223,39,160,60,116,208,18,227,228,61,45,9,77,33,51,206,234,253,204,229,110,79,49,2,198,40,174,91,202,129,210,14,63,148,56,125,1,28,200,241,236,221,105,15,193,26,182,126,184,120,102,178,133,71,16,74,46,216,48,25,101,132,232,36,146,70,176,34,84,118,151,158,235,156,149,166,243,145,130,122,52,82,22,230,144,124,187,251,4,162,224,24,97,168,35,85,72,183,88,121,80,173,86,201,139,29,17,41,215,104,109,69,163,242,57,169,218,142,65,157,154,112,231,147,244,189,114,250,12,164,7,115,255,180,222,246,249,21,195,66,117,192,238,194,240,90,59,32,58,140,67,44,207,138,185,181,211,203,175,128,245,94,42,11,53,143,19,197,78,83,31,152,81,226,96,153,209,119,87,170,127,37,99,190,159,64,217,248,108,93,186,5,213,95,252,89,177,76,136,131,98,172,10,111,155,219,254,6,55,141,8,107,150,237,137,23,188,233,20,103,75,54,199,73,92,167,205,123,47,220,196,212,161,171,165,13,30,191,134,225,62,179,3,135,100,113,43,106,0,27],[32,179,13,245,194,155,24,159,88,109,162,71,213,61,35,147,141,246,199,77,228,16,201,113,117,58,82,211,251,102,169,44,247,241,106,37,237,6,182,216,68,76,163,103,57,63,144,208,214,50,233,104,181,124,150,205,92,231,81,206,250,185,90,156,158,160,74,36,175,149,152,66,83,236,210,108,53,242,153,97,202,157,65,55,41,192,51,184,186,166,223,198,11,232,96,79,145,143,112,34,46,126,94,78,191,7,125,151,227,10,45,84,111,123,80,3,164,98,243,218,42,177,248,21,226,18,52,133,225,118,249,217,70,138,12,193,204,187,27,73,171,17,183,135,48,75,119,244,215,170,195,85,239,2,234,229,253,22,9,212,165,40,54,121,28,173,43,180,115,224,189,190,29,100,64,95,8,26,23,146,93,107,252,222,131,49,87,15,140,69,178,196,235,130,221,136,167,19,1,33,116,47,14,255,39,148,62,240,220,120,99,30,200,203,31,67,20,139,174,172,38,89,56,0,238,142,209,72,161,219,91,114,176,5,254,110,128,137,101,129,86,197,60,154,122,4,132,105,127,188,207,134,25,230,168,59],[65,185,115,250,248,108,77,184,95,67,224,79,163,191,22,71,119,245,138,200,59,153,142,151,223,170,113,91,217,196,44,93,68,17,23,234,186,40,240,162,2,0,227,15,251,206,92,229,75,12,64,24,130,141,21,135,36,129,76,137,197,86,213,29,46,27,50,107,102,253,252,61,60,43,187,120,175,152,179,125,181,1,174,177,83,149,53,219,38,4,57,3,74,144,173,178,158,139,20,238,87,194,56,13,58,131,254,126,132,84,30,14,207,112,81,127,214,176,167,41,189,73,246,128,147,111,201,155,146,236,150,242,104,55,218,198,16,89,7,11,99,118,145,8,164,192,221,94,51,140,69,183,203,96,28,157,230,202,66,237,116,156,159,220,45,247,133,34,216,48,117,222,6,215,154,241,255,103,211,97,160,122,225,210,188,233,19,9,195,205,239,39,148,171,98,80,235,190,18,226,212,231,90,134,35,232,168,47,49,209,228,25,193,136,161,37,72,249,180,32,243,62,52,166,169,143,124,121,182,110,31,78,204,109,26,33,101,54,85,100,244,123,10,114,172,70,42,106,165,63,82,199,105,208,5,88],[157,163,36,156,134,237,137,49,43,7,233,111,63,180,160,33,40,254,231,99,32,91,101,66,223,255,45,215,73,239,146,170,128,211,68,193,110,206,75,183,198,102,250,232,164,145,151,150,185,214,92,97,154,98,133,190,172,69,23,28,39,15,103,207,56,58,241,17,71,238,169,131,159,202,6,109,14,47,122,65,46,120,125,217,37,52,179,168,252,176,4,144,80,121,72,189,196,197,34,152,129,115,41,138,64,244,84,30,251,249,187,240,203,44,87,81,195,212,171,29,13,201,25,234,114,54,165,139,8,21,18,235,175,184,3,210,161,228,89,12,112,167,57,35,209,148,24,173,177,216,253,70,242,186,83,213,16,124,192,149,61,67,90,76,113,85,116,204,53,108,79,5,88,130,93,117,9,230,26,162,155,219,142,95,225,105,94,178,119,118,77,96,11,106,100,51,74,59,141,42,132,126,0,1,135,86,78,194,243,82,200,38,2,221,104,182,222,55,236,123,136,153,62,60,50,27,247,107,10,143,158,20,19,218,147,246,22,208,166,226,48,224,199,245,229,127,205,220,191,140,227,248,181,174,31,188],[127,27,14,218,33,125,82,178,74,213,138,77,55,38,153,246,26,221,110,242,142,61,145,171,113,207,62,13,98,143,93,8,249,241,239,136,236,254,50,208,135,73,83,48,231,21,58,237,133,186,102,117,157,193,200,201,248,19,29,87,166,222,51,167,210,70,107,245,255,25,104,158,191,66,234,31,159,47,64,252,164,60,5,12,244,194,91,32,132,79,2,151,247,162,130,189,176,24,195,20,108,163,229,37,122,243,154,53,230,40,225,106,209,253,6,181,10,146,95,1,39,56,187,198,128,235,36,184,134,216,211,68,238,103,97,144,175,220,78,205,131,177,30,69,34,190,44,105,42,35,116,121,179,169,22,115,72,232,199,233,28,212,118,224,170,180,71,185,183,123,94,152,147,18,197,202,45,41,150,111,23,80,52,120,109,7,168,46,215,227,203,217,49,88,114,228,240,155,140,9,174,85,17,90,43,89,141,67,161,63,99,196,129,16,84,188,3,206,101,76,165,15,172,81,126,124,11,65,219,96,148,100,92,75,4,119,139,214,192,149,57,86,59,156,251,223,137,0,112,226,250,173,182,160,54,204],[164,12,233,103,124,63,42,0,239,140,57,30,97,85,143,198,35,77,148,59,14,41,113,151,115,20,92,199,208,52,177,24,23,251,207,234,223,46,247,186,13,191,188,48,69,195,159,8,180,214,154,72,17,142,19,153,73,172,95,141,60,190,54,90,50,135,93,108,10,212,244,5,15,165,145,119,158,21,71,100,36,76,228,118,222,255,230,213,240,175,187,83,131,114,238,18,4,220,120,162,22,129,2,106,104,241,155,55,138,88,249,62,253,53,3,31,123,122,144,243,218,130,96,128,209,80,184,231,86,183,174,78,204,47,89,206,245,225,157,132,210,219,43,147,6,58,146,167,156,7,68,107,189,216,182,70,139,242,163,116,173,136,117,105,121,215,176,226,44,111,38,202,67,203,250,150,25,192,126,34,134,49,205,166,98,37,66,61,91,1,193,87,236,27,28,149,254,171,33,32,232,200,235,237,29,170,197,102,94,221,152,11,133,252,65,79,194,109,75,179,39,161,246,40,84,64,16,74,168,196,229,181,201,248,51,112,169,81,101,211,110,185,137,125,9,45,82,56,178,99,127,217,160,227,224,26],[18,34,142,230,136,194,153,221,93,73,96,108,45,244,133,139,103,198,91,28,178,219,56,248,187,212,196,174,42,181,118,128,201,67,228,204,195,3,32,5,111,132,148,206,217,190,184,182,125,84,245,19,2,223,253,134,10,147,238,115,155,104,122,189,255,49,69,146,160,173,9,15,61,29,234,7,151,218,141,98,86,83,222,145,14,186,216,81,210,75,225,90,169,78,112,21,53,179,117,54,172,227,127,177,27,247,249,152,215,236,123,100,208,211,1,17,193,26,63,205,72,33,0,240,116,47,162,85,237,120,250,129,66,23,55,243,246,232,41,11,80,144,60,251,22,39,59,89,161,20,150,130,113,65,154,191,43,157,121,233,167,203,137,48,202,171,140,12,239,158,95,87,209,105,88,24,109,58,124,6,192,200,241,99,166,164,159,77,138,36,188,224,231,50,175,213,31,25,8,38,180,52,102,176,149,46,126,92,13,40,163,97,76,252,214,106,114,51,170,183,16,229,197,70,37,4,74,68,35,71,242,185,254,57,64,82,30,79,119,199,94,235,168,135,220,62,143,156,131,44,101,226,110,107,207,165],[114,221,128,184,51,61,223,43,172,208,6,1,154,78,76,222,241,225,32,148,249,230,142,253,20,246,170,130,21,206,39,73,106,150,140,31,177,211,224,169,195,81,168,235,35,0,4,133,174,149,215,88,131,125,37,227,118,178,198,231,10,188,47,103,115,173,144,219,91,138,248,98,33,240,109,203,132,180,17,152,175,185,171,86,163,176,187,80,243,139,93,5,126,48,244,145,183,158,2,234,159,7,90,119,197,194,153,254,85,162,38,216,121,143,210,228,237,255,110,83,100,13,69,199,11,63,108,161,196,50,14,124,245,72,9,52,102,89,182,28,19,66,218,217,190,56,55,236,157,239,186,233,49,62,67,71,40,112,201,82,179,122,113,167,30,44,105,25,251,65,166,74,123,117,111,232,34,242,209,164,46,59,252,205,192,12,141,165,146,94,87,15,57,96,54,207,220,136,99,238,22,120,202,79,156,29,193,45,191,24,147,64,77,151,8,160,75,107,204,135,250,36,189,23,134,60,229,18,53,101,247,95,104,41,58,226,155,92,16,68,27,200,181,70,213,97,3,214,42,129,116,26,84,137,127,212],[110,195,87,70,132,237,41,131,203,163,106,157,200,126,172,51,4,246,75,63,218,108,161,215,42,186,159,115,2,35,61,229,180,183,55,15,124,138,232,73,100,160,175,245,66,133,242,50,114,23,173,222,127,207,152,243,149,240,247,34,101,30,194,16,40,88,249,14,28,170,122,176,19,120,105,244,33,59,81,181,74,129,118,148,219,211,43,128,123,17,198,111,217,65,25,213,64,125,6,196,49,184,225,165,202,89,227,224,99,156,20,92,255,3,47,189,199,39,95,231,178,86,77,53,8,44,71,143,94,188,37,233,12,253,239,177,251,223,5,248,83,137,151,84,209,226,1,192,7,139,82,90,162,220,158,204,0,68,171,216,119,54,187,208,166,190,228,60,234,205,145,10,230,48,78,116,210,98,109,62,144,142,241,214,58,72,121,13,136,112,11,57,27,236,104,93,193,154,179,29,235,117,197,153,24,107,21,32,96,56,18,155,9,103,85,140,185,169,130,67,168,238,147,45,254,146,91,174,212,26,102,164,182,97,80,46,250,221,76,36,79,206,150,69,38,167,252,201,52,191,134,31,22,141,135,113],[102,0,129,121,46,197,111,225,30,180,125,255,25,208,205,141,44,162,147,36,253,75,216,52,209,15,202,104,177,224,186,68,67,249,149,145,195,49,108,17,23,50,156,184,22,190,239,250,4,8,40,234,57,233,84,172,113,98,242,217,54,27,86,158,245,153,194,211,193,70,38,131,238,26,154,39,77,247,119,210,116,175,241,144,56,99,214,196,9,1,254,88,232,132,187,115,58,79,93,192,63,92,117,2,33,97,71,134,136,219,19,207,106,64,73,107,143,87,59,24,252,159,160,146,142,105,13,89,228,246,151,55,34,222,32,215,118,229,200,199,101,7,94,60,53,220,110,90,206,244,152,69,65,181,81,76,126,6,35,66,82,14,185,188,61,204,42,221,109,133,41,85,164,138,178,48,18,140,11,148,139,12,168,127,231,120,3,165,137,74,62,227,191,16,243,47,179,114,122,21,251,5,183,95,226,80,83,112,201,237,91,169,10,176,124,103,248,20,43,29,128,28,171,167,182,213,236,100,218,150,72,223,161,174,163,189,170,212,45,37,157,166,203,235,31,230,130,240,51,123,155,96,173,198,78,135]];
      
      private static var reversed_dictionary:Array = [];
       
      
      private var _key:Array;
      
      public function Encryption()
      {
         var _loc1_:int = 0;
         _key = [];
         super();
         _init_dictionary();
         _loc1_ = 0;
         while(_loc1_ < 12)
         {
            _key.push(_loc1_ + 10);
            _loc1_++;
         }
      }
      
      private static function _init_dictionary() : void
      {
         var _loc1_:int = 0;
         var _loc2_:int = 0;
         var _loc3_:int = 0;
         _loc3_ = 0;
         while(_loc3_ < 10)
         {
            _loc1_ = 0;
            while(_loc1_ < 256)
            {
               _loc2_ = 0;
               while(_loc2_ < 256)
               {
                  if(dictionary[_loc3_][_loc2_] != _loc1_)
                  {
                     _loc2_++;
                     continue;
                  }
                  break;
               }
               if(reversed_dictionary[_loc3_] == null)
               {
                  reversed_dictionary[_loc3_] = [];
               }
               reversed_dictionary[_loc3_][_loc1_] = _loc2_;
               _loc1_++;
            }
            _loc3_++;
         }
      }
      
      public static function getInstance() : org.specter3d.net.Encryption
      {
         if(instance == null)
         {
            instance = new org.specter3d.net.Encryption();
         }
         return instance;
      }
      
      public function encrypt(param1:ByteArray, param2:ByteArray, param3:int) : void
      {
         var _loc5_:int = 0;
         if(param1 == null || param2 == null)
         {
            return;
         }
         param1.position = 0;
         param2.position = 0;
         param2.length = 0;
         var _loc4_:int = param1.length;
         _loc5_ = 0;
         while(_loc5_ < _loc4_)
         {
            param2.writeByte(param1[_loc5_] ^ (param3 + _loc5_) % 255);
            _loc5_++;
         }
         param2.position = 0;
      }
      
      public function decrypt(param1:ByteArray, param2:ByteArray) : void
      {
         var _loc4_:int = 0;
         if(param1 == null || param2 == null)
         {
            return;
         }
         param1.position = 0;
         param2.position = 0;
         param2.length = 0;
         var _loc3_:int = param1.length;
         _loc4_ = _loc3_ - 1;
         while(_loc4_ >= 0)
         {
            param2.writeByte(reversed_dictionary[(_loc3_ + _loc4_) % 10][param1[_loc4_] ^ _key[_loc4_ % 12]]);
            _loc4_--;
         }
         param2.position = 0;
      }
   }
}
